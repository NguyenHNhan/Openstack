
sudo apt install mariadb-server
sudo systemctl enable mariadb
sudo systemctl start mariadb
NEWPASSDB="123"
echo -e "$NEWPASSDB\n$NEWPASSDB\ny\ny\ny\ny\n" | sudo mysql_secure_installation

sudo apt -y install software-properties-common 

sudo add-apt-repository cloud-archive:antelope
echo ""
sudo apt update 
sudo apt -y upgrade 
sudo apt -y install rabbitmq-server memcached python3-pymysql nginx libnginx-mod-stream 
sudo rabbitmqctl add_user openstack 123

sudo rabbitmqctl set_permissions openstack ".*" ".*" ".*" 

sudo wget -O /etc/mysql/mariadb.conf.d/50-server.cnf https://github.com/NguyenHNhan/Openstack/raw/12cd3a1d05f1c781a4ba2e43dce9cd9027b0857c/conf/50-server.cnf

sudo wget -O /etc/memcached.conf https://raw.githubusercontent.com/NguyenHNhan/Openstack/fa4d490951b72d673e78626558875345ad6445f8/conf/memcached.conf

sudo unlink /etc/nginx/sites-enabled/default

sudo systemctl restart mariadb rabbitmq-server memcached nginx 

sudo apt -y install keystone python3-openstackclient apache2 libapache2-mod-wsgi-py3 python3-oauth2client 



PASSDB="123"
SQL_COMMANDS="
DROP DATABASE IF EXISTS keystone;
CREATE DATABASE keystone;
GRANT ALL PRIVILEGES ON keystone.* TO stackdb@'localhost' IDENTIFIED BY '$PASSDB';
GRANT ALL PRIVILEGES ON keystone.* TO stackdb@'%' IDENTIFIED BY '$PASSDB';
FLUSH PRIVILEGES;
"
mysql <<< "$SQL_COMMANDS"
//cau hinh keystone
sudo wget -O /etc/keystone/keystone.conf https://github.com/NguyenHNhan/Openstack/raw/6839a9716c899a3bf834b5164bae41eb4693b009/conf/keystone.conf
